<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <p>Ajax대신 Fetch API를 사용하여 웹에 접근</p>
    <p>콜백으로 비동기접근이 아닌 promise와 await/async로 비동기 접근</p>

    <script>
        // fetch는 데이터의 CRUD 작업을 할수 있게 웹에 접근할수있다
        // http request, Response, POST, GET과 같은 메서드 작업가능
        /*  fetch(path)
            path : 데이터를 읽을 주소
            반환값 : 서버가 응당하는 값을 promise 객체로 반환
            
            ajax, fetch => http객체를 들고옴 
            fetch(get으로 들고옴)


         */
        fetch('./data.json')
            .then(pResponse => {
                //처음에 들어오는 반환값 : response 값(promise 객체)
                console.log(pResponse);
                return pResponse.text();
            })
            .then(pJSON => console.log(pJSON))
            // 다음을 return해준 값(여기서는 pResponse.text())
            /// then 을 이용해서 값을 받아올때까지 기다린다.

        
        // await와 async로 비동기 접근
        // await : 기다리다 > 함수 앞에 붙여주게되면 기다린다
        // async : 비동기 > await만 적으면 무한으로 기다리기때문에 async를 함수 앞에 붙여주게되면 비동기로 처리한다
        // 프로그래시브웹앱 책 80page
        async function dofetch() {
            const response = await fetch('./data.json');
            const data = await response.json();
            //값을 바로 들고와서 사용하는게 아니라 await를 사용해 기다렸다가 사용하도록 해본다
            //console.log(response.json());
            console.log(data)
        }

        async function ff() {
            let 밥그릇 = await new Promise(function (밥주기) {
                console.log(3); 
                밥주기('pizza');
            });
            return 밥그릇
        }
        async function ff2() {
            return 'pizza'
        }

            
    </script>
</body>
</html>